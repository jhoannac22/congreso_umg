{
  "phases": {
    "setup": {
      "nixPkgs": [
        "php83",
        "php83Extensions.bcmath",
        "php83Extensions.ctype",
        "php83Extensions.curl",
        "php83Extensions.dom",
        "php83Extensions.fileinfo",
        "php83Extensions.filter",
        "php83Extensions.hash",
        "php83Extensions.mbstring",
        "php83Extensions.openssl",
        "php83Extensions.pcre",
        "php83Extensions.pdo",
        "php83Extensions.pdo_mysql",
        "php83Extensions.session",
        "php83Extensions.tokenizer",
        "php83Extensions.xml",
        "php83Extensions.redis",
        "nodejs-22_x"
      ]
    },
    "install": {
      "cmds": [
        "composer install --optimize-autoloader --no-dev --no-interaction",
        "npm ci"
      ]
    },
    "build": {
      "cmds": [
        "npm run build",
        "mkdir -p storage/framework/{sessions,views,cache,testing} storage/logs bootstrap/cache",
        "chmod -R 775 storage bootstrap/cache"
      ]
    }
  },
  "start": {
    "cmd": "php artisan config:cache && php artisan route:cache && php artisan view:cache && php artisan serve --host=0.0.0.0 --port=$PORT"
  }
}

